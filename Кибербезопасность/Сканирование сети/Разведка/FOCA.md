# Введение 

**Foca** — это мощный инструмент для [извлечения и анализа](https://spy-soft.net/adel-android-data-extractor-lite/ "ADEL — Android Data Extractor Lite") метаданных. **Foca** может [извлекать данные](https://spy-soft.net/xplico/ "Xplico") из файлов **Microsoft Office**, **PDF** файлов, графических файлов и т.д. **Foca** может вытаскивать подробную информацию о месте где производилась фотосъёмка по сохранённым **GPS** данным.

Возможности утилиты **Foca**:

- — Extracts metadata from Open Office, MS Office, PDF, EPS and Graphic documents.
- — Uses Google, Bing and Exalead to find and examine the following file types on a target website – doc, ppt, pps, xls, docx, pptx, ppsx, xlsx, sxw, sxc, sxi, odt, ods, odg, odp, pdf, wpd, svg, svgz, indd, rdp , and ica.
- — From the extracted metadata, FOCA can find information on users, folders, printers, software, emails ,operating systems, passwords, servers and more.
- — Network Discovery
- — Fingerprinting
- — DNS Cache Snooping
- – discover what websites the internal users of a network are browsing on.
- — Exports data into a Report

---

# Использование

**Foca** сейчас нам нужна только ради одной функции — сканирование определенного домена в поисках документов в популярных форматах с помощью трех поисковиков (**Google, Bing и DuckDuckGo**) и последующим извлечением метаданных. Утилита также умеет анализировать метаданные [EXIF](https://spy-soft.net/exif-android/) из графических файлов, но к сожалению в этих полях редко находится что-то интересное.

Запускаем **FOCA**, жмем на «**Project**» и создаем новый проект. В правом верхнем углу отмечаем все форматы и жмем на «**Search All**». Поиск занимает до 10 минут.

В итоге в главном окне **FOCA** мы видим огромное количество файлов, которые утилита нашла на сайте. В нашем случае большую часть составили документы **PDF**.
![[Pasted image 20240707104553.png]]
Следующий шаг — это загрузка выбранных или всех файлов (контекстное меню → Download All) и после чего извлечение из них метаданных.

Давайте проанализируем, что нам удалось найти:
- Вкладка «Users» — В основном это имена пользователей, которые указываются при установке офисных пакетов. Они необходимы для последующей [социальной инженерии](https://spy-soft.net/social-engineering-techniques/) и подбора пар логин-пароль к обнаруженным в домене сетевым сервисам.
- Вкладка «Folders» — Здесь есть каталоги, которые указывают на использование ОС Windows (что подтверждается в дальнейшем), и часто попадается строка вида N:\\…. Я думаю, что это сетевой диск, который как правило подключается скриптом при входе пользователя в систему.
- Вкладка «Printers» — Теперь мы знаем модели сетевых принтеров (они начинаются с \\\\). Другие или локальные, или подключены через сервер печати.
- Вкладка «Software» — Здесь мы видим программное обеспечение, установленное на компьютерах. Самое интересное заключается в том, что указаны версии программ, из которых можно выбрать уязвимые и попробовать эксплуатировать их при атаке.
- Вкладка «Emails». Это мы и так имеем в достатке благодаря инструменту theHarvester.
- Вкладка «Operating Systems» — ОС, на которых создавались собранные нами файлы. Радует цифра 81 напротив Windows XP. Как правило, такие организации редко обновляют операционные системы. Есть большой шанс того, что старая версия Windows, для которой уже давно прекратили выпускать обновления безопасности, у них стоит по сей день.
![[Pasted image 20240707105006.png]]