## Part 1. Установка ОС

1. Установленный Ubuntu:
   ![[./assets_D01_Linux-1/Pasted image 20240724172748.png]]
2. Узнать версию Ubuntu:
   ```shell
   cat /etc/issue
	```
	![[./assets_D01_Linux-1/Pasted image 20240724173046.png]]

---

## Part 2. Создание пользователя

1. Создать пользователя `adm_user` с группой `adm`:
   ```shell
   sudo useradd -g adm adm_user
	```
	![[./assets_D01_Linux-1/Pasted image 20240724173350.png]]
	Альтернативный способ добавить пользователю группу (не при создании):
	
	```bash
	$ usermod -aG группа имя_пользователя
	```
	  - `-a` - add
	  - `-G` - если у пользователя уже были группы, они не отключатся от него

2. Проверка группы нового пользователя:
   ```shell
   sudo groups adm_user
	``` 
	![[./assets_D01_Linux-1/Pasted image 20240724174131.png]]
3. Поиск нового пользователя в `/etc/passwd`:
   ```shell
   sudo cat /etc/passwd | grep adm_user
	```
   ![[./assets_D01_Linux-1/Pasted image 20240724173846.png]]

---

## Part 3. Настройка сети ОС

1. Задать название машины вида `user-1`:
   - для 1 сессии:
   ```shell
   sudo hostname user-1
	```
	- задать постоянное название:
	```shell
	vi /ets/hostname 
	```
	```/ets/hostname 
	user-1
	```
	```shell
	reboot
	```
	![[./assets_D01_Linux-1/Pasted image 20240724175319.png]]
2. Установить временную зону, соответствующую текущему местоположению:
   ``` shell
   sudo timedatectl set-timezone Europe/Moscow
	```
   ![[./assets_D01_Linux-1/Pasted image 20240724175834.png]] 
3. Вывести названия сетевых интерфейсов:
   ``` shell
   ip a
	```
	![[./assets_D01_Linux-1/Pasted image 20240724180159.png]]
	**Альтернативные способы:** ![[./assets_D01_Linux-1/Pasted image 20240724181102.png]]
	**объяснение наличию интерфейса lo:** 
	> `loopback` адрес/интерфейс - зарезервированный локальный адрес `127.0.0.1`, используемый для ряда потребностей:
	> - Тестирование и отладка;
	> - Адресация проблем;
	> - Тестирование сетевых служб;
	> - Виртуализация.
	> В данном случае он используется именно для **виртуализации**. Т.е. используется в виртуализированой среде для создания виртуальных сетей и маршрутизации трафика между виртуальными машинами.
	
4. Получить **IP** адрес устройства можно по-прежнему командой:
   ``` shell
   ip a
	```
	![[./assets_D01_Linux-1/Pasted image 20240724180159.png]]
	В данном случае: `10.0.2.15` с маской подсети `/24`
	
	>**DHCP** - (Dynamic Host Configuration Protocol) - это протокол, который используется для автоматической настройки сетевых параметров устройствам в компьютерных сетях. Он позволяет устройствам автоматически получать IP-адрес, подсеть, шлюз по умолчанию и другие сетевые настройки от DHCP-сервера.

5. Определить и вывести на экран внешний **ip**-адрес шлюза (**ip**) и внутренний **IP**-адрес шлюза, он же **ip**-адрес по умолчанию (**gw**):
   ```shell
   ip route show
	```
	или 
	```shell
	ip r 
	```
	![[./assets_D01_Linux-1/Pasted image 20240724181845.png]]
	Где:
	> - `default via 10.0.2.2 dev enp0s3` - внешний **IP**-адрес шлюза;
   ```shell
   ip a
	```
	![[./assets_D01_Linux-1/Pasted image 20240724180159.png]]
	Где:
	> - `inet 10.0.2.15/24 metric 100 brd 10.0.2.255 scope global dynamic enp0s3` - выводит "`10.0.2.15`" - внутренний **IP**- адрес шлюза.
6. Чтобы задать статические настройки **IP**, **GW** и **DNS** на сервере **Ubuntu**, потребуется изменить файлы конфигурации сети:
   - Для **IP**, **GateWay** и **DNS**: `/etc/netpan/99-config.yaml`, но в моём случае пришлось сначала создать и заполнить другой файл: 
     `/etc/cloud/cloud.cfg.d/99-disable-network-config.cfg` ![[./assets_D01_Linux-1/Pasted image 20240724215532.png]]
     далее поставить значение `dhcp4: no` в файле `/etc/netpan/50-cloud-init.yaml` ![[./assets_D01_Linux-1/Pasted image 20240724222405.png]]
     и наконец: `/etc/netplan/99-config.yaml`
	 
	   ``` shell
	   sudo vi /etc/netplan/99-config.yaml
		```
		```/etc/netplan/99-config.yaml
		network:
		  version: 2
		  renderer: networkd
		  ethernets:
		    enp0s3:
		      addresses:
		        - 10.10.2.10/24
		    routes:
		      - to: default
		        via: 10.0.2.2
		    nameservers:
		      addresses: [10.0.2.2, 1.1.1.1, 8.8.8.8]
		 ```
		![[./assets_D01_Linux-1/Pasted image 20240725151511.png]]
		 ```
		 reboot 
		```
		Настройки остались примерёнными и `ping` работает:
		![[./assets_D01_Linux-1/Pasted image 20240725153114.png]]
		![[./assets_D01_Linux-1/Pasted image 20240725153250.png]]

---

## Part 4. Обновление ОС

```shell
sudo apt update && sudo apt upgrade -y && sudo apt autoremove
```
![[./assets_D01_Linux-1/Pasted image 20240725155015.png]]

---

## Part 5. Использование команды **sudo**

1. Разрешить пользователю "`adm_user`" выполнять "`sudo`":
   Есть несколько способов, я же просто добавлю пользователю "`adm_user`" группу "`sudo`" 
   ``` shell
     sudo usermod -aG sudo adm_user
	```
2. Назначение команды "`sudo`": 
   > Команда `sudo` в **Linux** используется для выполнения команд с привилегиями **суперпользователя**, также известного как **root**. Когда пользователь выполняет команду с использованием `sudo`, он получает временные привилегии **root**, что позволяет ему выполнять задачи, требующие повышенных привилегий, таких как установка программного обеспечения, изменение системных настроек и т. д..
   > 
   > _Права пользователя_ `root` _и группы_ `sudo` _тоже можно редактировать. Это делается через файл_ "`/etc/sudoers`".
   
3. Замена **hostname** ОС от имени пользователя `adm_user`:
	```shell
	su adm_user
	```
	```shell
	sudo vi /etc/hostname
	```
	```/etc/hostname
	user-2
	```
	```shell
	reboot
	```
	![[./assets_D01_Linux-1/Pasted image 20240725164330.png]]

---

## Part 6. Установка и настройка службы времени

Ранее я уже выполнил этот пункт верно, но повторю:
``` shell
sudo timedatectl set-timezone Europe/Moscow
```
![[./assets_D01_Linux-1/Pasted image 20240725164727.png]]

---

## Part 7. Установка и использование текстовых редакторов

---

#### Vim
**Создать, заполнить, сохранить файл:**
1. Создать файл "`test_vim.txt`": `vim test_vim.txt`;
2. `i` - режим ввода: `i starfird`;
   ![[./assets_D01_Linux-1/Pasted image 20240725165618.png]]
3. `^C` - режим наблюдения;
4. `ZZ` - сохранить и выйти.

**Открыть, изменить, выйти без сохранения:**
1. Открыть: `vim test_vim.txt`;
2. Изменить первую строку: 
   - `dd` - удалить строку
   - `-i` - режим ввода
     ![[./assets_D01_Linux-1/Pasted image 20240725171633.png]]
3. `^C :q!` - выйти без сохранения

**Поиск и замена:**
1. Поиск: 
   - `/` - обычный поиск
   - `?` - обратный поиск
     ![[./assets_D01_Linux-1/Pasted image 20240725172054.png]]
 2. Замена `qwe` на `EWQ`:
    - `:s/{old_word}/{new_word}/g`
      > `/g` - для замены всех слов в тексте
      > `/c` - для замены с подтверждением
      
      ![[./assets_D01_Linux-1/Pasted image 20240725172522.png]]

---

#### Nano

**Создать, заполнить, сохранить файл:**
1. Создать файл "`test_nano.txt`": `nano test_nano.txt`;
2. Режим ввода стоит по умолчанию;
   ![[./assets_D01_Linux-1/Pasted image 20240725172821.png]]
4. `^S^X` - сохранить и выйти.

**Открыть, изменить, выйти без сохранения:**
1. Открыть: `nano test_nano.txt`;
2. Изменить первую строку: 
   - *Обычный ввод*
     ![[./assets_D01_Linux-1/Pasted image 20240725173133.png]]
3. `^Xn` - выйти без сохранения

**Поиск и замена:**
1. Поиск: 
   - `^W` - обычный поиск
     ![[./assets_D01_Linux-1/Pasted image 20240725173507.png]]
     > Чтобы найти следующее вхождение слова, нажмите клавишу `Ctrl+W` снова.
 2. Замена `EWQ` на `qwe`:
    - `^\`
      > `A` - для замены всех слов в тексте
      > `Enter` - для замены только текущего слова
      
      ![[./assets_D01_Linux-1/Pasted image 20240725173950.png]]

---

#### Emacs

**Создать, заполнить, сохранить файл:**
1. Создать файл "`test_emacs.txt`": `emacs test_emacs.txt`;
2. Режим ввода стоит по умолчанию;
   ![[./assets_D01_Linux-1/Pasted image 20240725175246.png]]
4. `^X^S^X^C` - сохранить и выйти.

**Открыть, изменить, выйти без сохранения:**
1. Открыть: `emacs test_emacs.txt`;
2. Изменить первую строку: 
   - *Обычный ввод*
     ![[./assets_D01_Linux-1/Pasted image 20240725175307.png]]
3. `^X^Cnyes` - выйти без сохранения

**Поиск и замена:**
1. Поиск: 
   - `^S` - обычный поиск
     ![[./assets_D01_Linux-1/Pasted image 20240725175524.png]]
     > Чтобы найти следующее вхождение слова, нажмите клавишу `Ctrl+S` снова.
     > Чтобы найти предыдущее вхождение слова, нажмите клавишу `Ctrl+R`.
 1. Замена `EWQ` на `qwe`:
    - `Alt+%` (или `Esc+%`), введите слово, **которое** вы хотите заменить, и слово, **на которое** вы хотите заменить, и нажмите клавишу `Enter`. **Emacs** будет предлагать заменить каждое вхождение слова по очереди.
    
      >- `y` (от "yes") - заменить текущее вхождение слова и перейти к следующему.
      >- `n` (от "no") - не заменять текущее вхождение слова и перейти к следующему.
      >- `!` (от "yes to all") - заменить все оставшиеся вхождения слова без запроса на подтверждение.
      >- `q` (от "quit") - прекратить замену и выйти из режима замены.
      >- `.` (точка) - оставить текущее вхождение слова без замены и перейти к следующему.
      >- `C-r` (от "Ctrl+r") - отменить последнюю замену и вернуться к предыдущему вхождению слова.
      
      ![[./assets_D01_Linux-1/Pasted image 20240725175959.png]]

---

## Part 8. Установка и базовая настройка сервиса **SSHD**

1. Установка службы **SSHd**:
   ```shell
   sudo apt-get install openssh-server
	```
2. Добавить SSHd в автозапуск:
   >В большинстве дистрибутивов **Linux** служба **SSHd** автоматически запускается при загрузке системы после ее установки.
   
   - Чтобы добавить службу в автозапуск вручную необходимо проверить следующий файл `/etc/systemd/system/sshd.serviсe` и добавить поле `After` в категорию `[Unit]`: 
     ![[./assets_D01_Linux-1/Pasted image 20240725192246.png]]
   - Прописать команды: 
		```shell
		sudo systemctl daemon-reload 
		```
			
		```shell
		sudo systemctl restart sshd
		```
3. Перенастроить стандартный порт на `2022`:
   ```shell
   sudo vi /etc/ssh/sshd_config
	```
	- Найти строку `PORT=...` и изменить значение на `2022`:
	  ![[./assets_D01_Linux-1/Pasted image 20240725192928.png]]
4. команда `ps -aux` для вывода работающих процессов:
      ![[./assets_D01_Linux-1/Pasted image 20240725193239.png]]
      Где:
      - `-a` - отображает процессы всех пользователей на терминале, включая процессы других пользователей.
      - `-u` - добавляет колонку с информацией о владельце (пользователе) для каждого процесса.
      - `-x` - отображает процессы, не связанные с каким-либо терминалом (не имеющие контролирующего терминала).
5. `reboot` + проверка сети командой `netstat`:
   ``` shell
   netstat -tan
	```
	Где: 
	![[./assets_D01_Linux-1/Pasted image 20240725194507.png]]
	**Ключи**
	- `-t` - отображает только TCP-соединения.
	- `-a` - отображает все соединения, включая прослушивающие порты и установленные соединения.
	- `-n` - отображает сетевые адреса и порты в числовом формате, без попытки их разрешения в имена хостов или служб.

	**Столбцы**
	- `Proto` - указывает на протокол, используемый для соединения (в данном случае TCP).
	- `Recv-Q` - указывает количество байтов, находящихся в очереди на прием данных для соединения. Это количество байтов, которые ожидают обработки и чтения приложением, установившим соединение. Если значение `Recv-Q` становится слишком большим, пакеты могут быть отброшены, так как нет места для их размещения.
	- `Send-Q` -  указывает количество байтов, находящихся в очереди на отправку данных для соединения. Это количество байтов, которые ожидают отправки на удаленный узел. Если значение `Send-Q` ненулевое, это может указывать на проблему с получателем, который не подтверждает получение данных.
	- `Local Adress` - отображает локальный IP-адрес и порт, на котором происходит соединение.
	- `Foreign Adress` - показывает внешний IP-адрес и порт удаленного узла, с которым установлено соединение.
	- `State` - - указывает текущее состояние соединения, например, установлено (ESTABLISHED), слушается (LISTEN), ожидает (WAIT), закрыто (CLOSED) и т. д.

	**0.0.0.0** обозначает "любой адрес" или "любой интерфейс". Когда программа или служба связывается с адресом `0.0.0.0`, она слушает все доступные сетевые интерфейсы на устройстве. Это позволяет принимать входящие соединения на любом доступном интерфейсе и порту.

---

## Part 9. Установка и использование утилит **top**, **htop**

---

### top

1. **uptime** - время работы системы: 
   ![[./assets_D01_Linux-1/Pasted image 20240726153339.png]]
2. **количество авторизованных пользователей:** 
   ![[./assets_D01_Linux-1/Pasted image 20240726153425.png]]
3. **общая загрузка системы:** 
   ![[./assets_D01_Linux-1/Pasted image 20240726154153.png]]
   > отображает средние параметры за 1, 5 и 15 минут.
4. **общее количество процессов:**
   ![[./assets_D01_Linux-1/Pasted image 20240726154446.png]]
5. **загрузка CPU:**
   ![[./assets_D01_Linux-1/Pasted image 20240726154625.png]]
   Где:
   > **us** - пользовательские процессы;
   > **su** - процессы ядра;
   > **id** - неиспользуемые ресурсы;
   > **wa** - операции ввода/вывода, т.е. дисковые операции.
6. **Загрузка памяти:**
   ![[./assets_D01_Linux-1/Pasted image 20240726171650.png]]
   Где:
   > **Mem** - физическая память (RAM) в системе.
   > **Swap** - область на диске, которая используется в качестве виртуальной памяти, когда физическая память (RAM) исчерпана.
   > **total** - общий объём памяти.
   > **free** - свободная память.
   > **used** - используемая память в данный момент.
   > **buff/cache** - память для буферов и кэша.
   > **avail Mem** - доступна физическая память, которая может быть использована без необходимости использовать **swap**-память.
7. **pid процесса, занимающего больше всего памяти:** `shift+M`
   ![[./assets_D01_Linux-1/Pasted image 20240726195726.png]]
8. **pid процесса, занимающего больше всего процессорного времени:** `shift+P`
   ![[./assets_D01_Linux-1/Pasted image 20240726200041.png]]

---

### htop

![[./assets_D01_Linux-1/Pasted image 20240726200420.png]]

1. Сортировка осуществляется через клавишу `F6` и выбор нужной колонки через `Enter`:

	**PID**
	![[./assets_D01_Linux-1/Pasted image 20240726200811.png]]
	
	**PERCENT_CPU**
	![[./assets_D01_Linux-1/Pasted image 20240726200835.png]]
	
	**PERCENT_MEM**
	![[./assets_D01_Linux-1/Pasted image 20240726200852.png]]
	
	**TIME**
	![[./assets_D01_Linux-1/Pasted image 20240726200917.png]]

2. Фильтрация осуществляется через или `F4`. В данном случае по процессу `sshd`:
   ![[./assets_D01_Linux-1/Pasted image 20240726201143.png]]
3. Поиск - `F3`. В данном случае поиск процесса `syslog`:
   ![[./assets_D01_Linux-1/Pasted image 20240726201440.png]]
4. Добавить новые колонки - `F2` -> `Meters`:
   ![[./assets_D01_Linux-1/Pasted image 20240726202549.png]]

---

## Part 10. Использование утилиты **fdisk**

![[./assets_D01_Linux-1/Pasted image 20240726202817.png]]

Здесь:
1. Названия жёсткого диска: `/dev/sda`;
2. Размеры жёсткого диска: `25GiB` (гигабайт);
3. `52428800` секторов;
4. Размер `Swap` на моём устройстве не отображается через `fdisk -l`, поэтому я использовал `swapon -s` и получил ответ - `2402400` байт.
   ![[./assets_D01_Linux-1/Pasted image 20240726210427.png]]

---

## Part 11. Использование утилиты **df**

``` shell
df /
```
![[./assets_D01_Linux-1/Pasted image 20240726210705.png]]
Здесь:
1. Размер раздела: `11758760` байт;
2. Размер занятого пространства: `5750584` байта;
3. Размер свободного пространства: `5389068` байт;
4. Процент использования: `52%`;
5. Единица измерения - **байт**.

```shell
df -Th /
```
![[./assets_D01_Linux-1/Pasted image 20240726211345.png]]
Здесь:
1. Размер раздела: `12` гигабайт;
2. Размер занятого пространства: `5.5` гигабайт;
3. Размер свободного пространства: `5.2` гигабайт;
4. Процент использования: `52%`;
5. тип файловой системы для раздела - **ext4**.

---

## Part 12. Использование утилиты **du**

```shell
du
```
1. Размер `/home`: `1.6` мегабайт;
   ![[./assets_D01_Linux-1/Pasted image 20240726212250.png]]
2. Размер `/var`: `533` мегабайта;
   ![[./assets_D01_Linux-1/Pasted image 20240726213120.png]]
3. Размер `/var/log`: `227` мегабайт;
   ![[./assets_D01_Linux-1/Pasted image 20240726212514.png]]
4. Размер всего содержимого в `/var/log` (у меня не поместилось в терминал, но, думаю, этого достаточно):
   ![[./assets_D01_Linux-1/Pasted image 20240726220107.png]]

---

## Part 13. Установка и использование утилиты **ncdu**

``` shell
ncdu /
```
```ncdu
i             # вывод информации о выбранном объекте
right / Enter # перейти в выбранную директорию
```
1. `/home`:
   ![[./assets_D01_Linux-1/Pasted image 20240727143700.png]]
1. `/var`
   ![[./assets_D01_Linux-1/Pasted image 20240727143744.png]]
3. `/var/log`
   ![[./assets_D01_Linux-1/Pasted image 20240727143833.png]]

---

## Part 14. Работа с системными журналами

1. `/var/log/dmesg`:
   Папка `/var/log/dmesg` содержит информацию о буфере ядра в **Linux**. Когда система загружается, ядро выводит на экран сообщения о обнаруженных аппаратных устройствах. Эти сообщения доступны в буфере ядра, и при поступлении нового сообщения старое сообщение перезаписывается.
   
   Однако, важно отметить, что в некоторых дистрибутивах **Linux**, таких как **Ubuntu**, информация из буфера ядра может быть доступна в других файлах, таких как `/var/log/kern.log` или `/var/log/syslog`. Поэтому, в **Ubuntu**, файл `/var/log/dmesg` может быть пустым или содержать ограниченное количество сообщений.
   ![[./assets_D01_Linux-1/Pasted image 20240727144922.png]]
2. `/var/log/syslog`:
   Папка `/var/log/syslog` на **Linux**-системах используется для хранения системных журналов (логов). В этой папке содержатся записи о различных событиях, происходящих в системе, таких как сообщения ядра, информация о запуске и остановке служб, ошибки и предупреждения, а также другая системная информация.
   
   Файлы в папке `/var/log/syslog` могут быть полезными при диагностике и отладке системы, а также при анализе производительности и выявлении проблем. Они могут содержать информацию о сетевых подключениях, авторизации пользователей, ошибки файловой системы и другие системные события.
   ![[./assets_D01_Linux-1/Pasted image 20240727145205.png]]
3. `/var/log/auth.log`:
   Папка `/var/log/auth.log` на **Linux**-системах используется для хранения журналов авторизации пользователей. В этой папке содержатся записи о попытках входа в систему, как успешных, так и неуспешных, а также информация о пользователях, методах аутентификации и других событиях, связанных с авторизацией.
   ![[./assets_D01_Linux-1/Pasted image 20240727145405.png]]

**Время последней успешной авторизации, имя пользователя и метод входа в систему:**
``` shell
cat /var/log/auth.log | grep login
```
![[./assets_D01_Linux-1/Pasted image 20240727150455.png]]
Отсюда: 
- Время: `2024-07-27` `14::32:32`;
- Имя пользователя: `ubuntu`;
- Метод входа: `login[910]` - то есть обычная авторизация. `910` и `773` - **PID** процессов.

**сообщение о рестарте службы:**
``` 
cat /var/log/auth.log | grep sshd
```
![[./assets_D01_Linux-1/Pasted image 20240727151706.png]]

---

## Part 15. Использование планировщика заданий **CRON**

1. Запустить команду `uptime` через каждые 2 минуты:
   ``` shell
	crontab -e
	```
	![[./assets_D01_Linux-1/Pasted image 20240727181518.png]]
2. Строчки о выполнении в логах:
   ![[./assets_D01_Linux-1/Pasted image 20240727181435.png]]
3. Список текущих задач для `cron`: `crontab -l`
   ![[./assets_D01_Linux-1/Pasted image 20240727180714.png]]
4. Удалить все текущие задачи для `cron`: `crontab -r`
   ![[./assets_D01_Linux-1/Pasted image 20240727181545.png]]